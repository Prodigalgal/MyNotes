# 3DES

## 问题

### 1、密钥长度

密钥只支持 16 位和 24 位的



# 扩展

## PKCS5

PKCS5 是 8 字节填充的，使内容成为 8 的整数倍，填充的内容取决于需要填充的数目

例 0x56 在经过 PKCS5 填充之后会成为 0x56 0x07 0x07 0x07 0x07 0x07 0x07 0x07因为需要填充 7 字节，因此填充的内容就是 7

特殊情况下，即使满足了 8 的整倍数，仍然需要在尾部填充 8 个字节，并且内容是 0x08，目的是为了加解密时统一处理填充

PKCS7 与 PKCS5 的区别在于 PKCS5 只填充到 8 字节倍数，而 PKCS7 可以在 1-255 之间任意填充

PKCS5 是 PKCS7 的一个子集，在 PKCS7 的 BlockSize 为 8 的时候，与 PKCS5 是一样的，在 BlockSize 不同时PKCS5 与 PKCS7 是不同的，PKCS5 填充是将数据填充到 8 的倍数，填充后数据长度的计算公式是，定元数据长度为 x， 填充后的长度是 x + (8 - (x % 8))，填充的数据是 8 - (x % 8)

因此 PKCS5 可以向上转换为 PKCS7，但是 PKCS7 不一定可以转换到 PKCS5，用 PKCS7 填充加密的密文，可以用PKCS5 解出来


AES 等算法，把 BlockSize 扩充到 16 个字节，因为 AES 并没有 64 位的块，如果采用 PKCS5，那么实质上就是采用 PKCS7



